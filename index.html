<!doctype html>
<meta charset='utf-8'>
<title>Animal Hunt</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<style>
  body { margin: 0; font-family: Arial; }
  #camera { width: 100%; height: 100vh; display: block; }
  #game { position: relative; width: 100%; height: 100vh; overflow: hidden; }
  .animal { position: absolute; font-size: 60px; transition: font-size 0.1s; }
  #permissionBtn { position: absolute; top: 20px; left: 20px; z-index: 100; padding: 10px 20px; font-size: 16px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
</style>

<button id="permissionBtn">Start Motion Detection</button>

<div id="game">
  <video id="camera" autoplay playsinline></video>
  <div id="animals"></div>
</div>

<script>
  const video = document.getElementById('camera');
  const animalsContainer = document.getElementById('animals');
  const animals = ['ðŸ¦', 'ðŸ˜', 'ðŸ¦’', 'ðŸ…', 'ðŸ¦“', 'ðŸ»', 'ðŸ¦Š', 'ðŸ’'];
  const activeAnimals = [];
  let tiltForward = 0;

  // Start camera
  navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
    .then(stream => video.srcObject = stream);

  // Request motion permission on button click
  document.getElementById('permissionBtn').addEventListener('click', async () => {
    if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
      try {
        const permission = await DeviceOrientationEvent.requestPermission();
        if (permission === 'granted') {
          document.getElementById('permissionBtn').textContent = 'âœ“ Motion Enabled';
          document.getElementById('permissionBtn').disabled = true;
        }
      } catch (error) {
        alert('Motion permission denied');
      }
    } else {
      // Non-iOS, just enable it
      document.getElementById('permissionBtn').textContent = 'âœ“ Motion Enabled';
      document.getElementById('permissionBtn').disabled = true;
    }
  });

  // Track phone tilt
  window.addEventListener('deviceorientation', (event) => {
    tiltForward = event.beta || 0;
  });

  // Spawn random animals every 2 seconds
  setInterval(() => {
    const animal = document.createElement('div');
    animal.className = 'animal';
    animal.textContent = animals[Math.floor(Math.random() * animals.length)];
    animal.style.left = Math.random() * 80 + '%';
    animal.style.top = Math.random() * 80 + '%';
    const animalObj = { element: animal, size: 60 };
    activeAnimals.push(animalObj);
    animalsContainer.appendChild(animal);

    setTimeout(() => {
      animal.remove();
      activeAnimals.splice(activeAnimals.indexOf(animalObj), 1);
    }, 8000);
  }, 2000);

  // Update sizes based on tilt
  setInterval(() => {
    activeAnimals.forEach(a => {
      a.size = 60 + (tiltForward * 2);
      a.size = Math.max(60, Math.min(150, a.size));
      a.element.style.fontSize = a.size + 'px';
    });
  }, 50);
</script>
